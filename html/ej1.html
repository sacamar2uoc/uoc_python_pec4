<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>ej1 API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ej1</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import pandas as pd
import re
import dask.dataframe as dd

    
&#39;&#39;&#39;
Execute
do_message_covid_approval_polls()

1.2 ¿Si tuviéramos un archivo de 1Gb lo harías igual? Si no es así, implementar la solución para este caso.
La implementación está en la función get_clean_data_big.

1.3 ¿Si tuviéramos 100 archivos de 1Gb cómo lo harías? No hace falta implementar la solución, sólo una pequeña descripción de cómo resolverías el problema.
La función implementada en la sección 1.2 del ejercicio sería llamada en concurrencia usando multithreading.
Se haría una lista de los nombres de cada csv y se pasaría a la función que tuviera el multithread, su ouput sería fusionado en un dataframe de dask o un parquet.
&#39;&#39;&#39;

def main_do_message_covid_approval_polls():
    &#39;&#39;&#39;
    Muestra los datos de la frecuencia de los patrones por pantalla.
    &#39;&#39;&#39;
    freq_patterns=build_freq_patterns_covid_approval_polls()
    print(f&#39;There are {freq_patterns[0]} polls sponsored by Huffington Post&#39;)
    print(f&#39;There are {freq_patterns[1]} polls showing its info on pdf format&#39;)


def get_clean_data_csv(csv_filename,cols=&#34;all&#34;):
    &#39;&#39;&#39; Este método se encargará de recoger los datos de cualquier csv y limpiarlos bajo el mismo estandar:
    quitar los elementos nulos, los strings en minuscula y sustituir los espacios por barra baja&#39;&#39;&#39;
    if cols==&#34;all&#34;:
        raw_data=pd.read_csv(csv_filename,na_filter=True,keep_default_na=False)
    else:
        raw_data=pd.read_csv(csv_filename,usecols=cols,na_filter=True,keep_default_na=False)
    col_names=raw_data.columns.values
    clean_data=pd.DataFrame()
    
    for cn in col_names:
        aux_field=raw_data[cn]
        try:
            clean_data[cn]=[aux_row.lower().replace(&#34; &#34;,&#34;_&#34;) for aux_row in raw_data[cn]]
        except Exception as e:
            clean_data[cn]=raw_data[cn]
            pass
    
    return clean_data

def build_freq_patterns_covid_approval_polls():
    &#39;&#39;&#39;
    Este método calcula la frecuencia de dos patrones en los campos sponsor y url.
    Su output es una tupla de dos valores float.
    &#39;&#39;&#39;
    hp_pattern=&#34;huffington_post&#34;
    http_pattern=r&#34;http:\/\/(.*)[.]pdf|https:\/\/(.*)[.]pdf&#34;
    freq_hp,freq_http=0,0
    
    field_names=[&#39;sponsor&#39;,&#39;url&#39;]
    
    try:
        covid_approval_polls=get_clean_data_csv(&#34;./data/covid_approval_polls.csv&#34;,field_names)
    except Exception as e:
        print(e)
        return 1
    
    for i in range(len(covid_approval_polls)):
        aux_sponsors=covid_approval_polls[&#39;sponsor&#39;].iloc[i]
        aux_url=covid_approval_polls[&#39;url&#39;].iloc[i]
        freq_http+=1 if (len(re.findall(http_pattern,aux_url))&gt;0) else 0
        freq_hp+=1 if aux_sponsors==hp_pattern else 0
    return freq_http,freq_hp


def get_clean_data_big(csv_filename):
    &#39;&#39;&#39;
    Este método esta especialmente diseñado para leer archivos de gran tamaño usando la librería dask
    &#39;&#39;&#39;
    raw_data=dd.read_csv(csv_filename)
    return raw_data</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="ej1.build_freq_patterns_covid_approval_polls"><code class="name flex">
<span>def <span class="ident">build_freq_patterns_covid_approval_polls</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Este método calcula la frecuencia de dos patrones en los campos sponsor y url.
Su output es una tupla de dos valores float.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def build_freq_patterns_covid_approval_polls():
    &#39;&#39;&#39;
    Este método calcula la frecuencia de dos patrones en los campos sponsor y url.
    Su output es una tupla de dos valores float.
    &#39;&#39;&#39;
    hp_pattern=&#34;huffington_post&#34;
    http_pattern=r&#34;http:\/\/(.*)[.]pdf|https:\/\/(.*)[.]pdf&#34;
    freq_hp,freq_http=0,0
    
    field_names=[&#39;sponsor&#39;,&#39;url&#39;]
    
    try:
        covid_approval_polls=get_clean_data_csv(&#34;./data/covid_approval_polls.csv&#34;,field_names)
    except Exception as e:
        print(e)
        return 1
    
    for i in range(len(covid_approval_polls)):
        aux_sponsors=covid_approval_polls[&#39;sponsor&#39;].iloc[i]
        aux_url=covid_approval_polls[&#39;url&#39;].iloc[i]
        freq_http+=1 if (len(re.findall(http_pattern,aux_url))&gt;0) else 0
        freq_hp+=1 if aux_sponsors==hp_pattern else 0
    return freq_http,freq_hp</code></pre>
</details>
</dd>
<dt id="ej1.get_clean_data_big"><code class="name flex">
<span>def <span class="ident">get_clean_data_big</span></span>(<span>csv_filename)</span>
</code></dt>
<dd>
<div class="desc"><p>Este método esta especialmente diseñado para leer archivos de gran tamaño usando la librería dask</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_clean_data_big(csv_filename):
    &#39;&#39;&#39;
    Este método esta especialmente diseñado para leer archivos de gran tamaño usando la librería dask
    &#39;&#39;&#39;
    raw_data=dd.read_csv(csv_filename)
    return raw_data</code></pre>
</details>
</dd>
<dt id="ej1.get_clean_data_csv"><code class="name flex">
<span>def <span class="ident">get_clean_data_csv</span></span>(<span>csv_filename, cols='all')</span>
</code></dt>
<dd>
<div class="desc"><p>Este método se encargará de recoger los datos de cualquier csv y limpiarlos bajo el mismo estandar:
quitar los elementos nulos, los strings en minuscula y sustituir los espacios por barra baja</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_clean_data_csv(csv_filename,cols=&#34;all&#34;):
    &#39;&#39;&#39; Este método se encargará de recoger los datos de cualquier csv y limpiarlos bajo el mismo estandar:
    quitar los elementos nulos, los strings en minuscula y sustituir los espacios por barra baja&#39;&#39;&#39;
    if cols==&#34;all&#34;:
        raw_data=pd.read_csv(csv_filename,na_filter=True,keep_default_na=False)
    else:
        raw_data=pd.read_csv(csv_filename,usecols=cols,na_filter=True,keep_default_na=False)
    col_names=raw_data.columns.values
    clean_data=pd.DataFrame()
    
    for cn in col_names:
        aux_field=raw_data[cn]
        try:
            clean_data[cn]=[aux_row.lower().replace(&#34; &#34;,&#34;_&#34;) for aux_row in raw_data[cn]]
        except Exception as e:
            clean_data[cn]=raw_data[cn]
            pass
    
    return clean_data</code></pre>
</details>
</dd>
<dt id="ej1.main_do_message_covid_approval_polls"><code class="name flex">
<span>def <span class="ident">main_do_message_covid_approval_polls</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Muestra los datos de la frecuencia de los patrones por pantalla.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def main_do_message_covid_approval_polls():
    &#39;&#39;&#39;
    Muestra los datos de la frecuencia de los patrones por pantalla.
    &#39;&#39;&#39;
    freq_patterns=build_freq_patterns_covid_approval_polls()
    print(f&#39;There are {freq_patterns[0]} polls sponsored by Huffington Post&#39;)
    print(f&#39;There are {freq_patterns[1]} polls showing its info on pdf format&#39;)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="ej1.build_freq_patterns_covid_approval_polls" href="#ej1.build_freq_patterns_covid_approval_polls">build_freq_patterns_covid_approval_polls</a></code></li>
<li><code><a title="ej1.get_clean_data_big" href="#ej1.get_clean_data_big">get_clean_data_big</a></code></li>
<li><code><a title="ej1.get_clean_data_csv" href="#ej1.get_clean_data_csv">get_clean_data_csv</a></code></li>
<li><code><a title="ej1.main_do_message_covid_approval_polls" href="#ej1.main_do_message_covid_approval_polls">main_do_message_covid_approval_polls</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>